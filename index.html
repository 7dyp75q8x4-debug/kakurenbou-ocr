<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>UI Base - Improved Right Side</title>

<style>
    body {
        margin: 0;
        padding: 0;
        display: flex;
        height: 100vh;
        overflow: hidden;
        background: #f5f5f5;
        font-family: sans-serif;
    }

    /* 全体を左右２エリアに分割 */
    #leftArea {
        width: 52%; /* 左は現状キープ */
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        grid-template-rows: repeat(5, 1fr);
        gap: 4px;
        padding: 8px;
        box-sizing: border-box;
    }

    .slot {
        background: #fff;
        border: 1px solid #ccc;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        border-radius: 4px;
    }

    /* 右側 */
    #rightArea {
        width: 48%; /* カメラを広げるため増量 */
        display: flex;
        flex-direction: column;
        padding: 8px;
        box-sizing: border-box;
    }

    /* カメラ：右側を広げたので高さを拡大 */
    #cameraContainer {
        width: 100%;
        height: 32%; /* B案：少し縦に伸ばした */
        background: #000;
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 6px;
    }

    video {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    /* ログ */
    #log {
        flex: 1;
        background: #fff;
        border: 1px solid #bbb;
        border-radius: 6px;
        padding: 6px;
        font-size: 13px;
        overflow-y: auto;
        margin-bottom: 8px;
    }

    /* ボタンエリア：2×2 */
    #buttonGrid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        gap: 6px;
        height: 26%;
    }

    button {
        width: 100%;
        height: 100%;
        font-size: 14px;
        border-radius: 6px;
        border: none;
        background: #ddd;
    }

    /* モード切り替えの色 */
    .active-red {
        background: #ff4b4b !important;
        color: #fff;
    }
    .active-green {
        background: #00b44b !important;
        color: #fff;
    }
</style>
</head>

<body>

<!-- 左側：5×4スロット（絶対変更しない） -->
<div id="leftArea">
    <div class="slot">1a</div><div class="slot">1b</div><div class="slot">1c</div><div class="slot">1d</div>
    <div class="slot">2a</div><div class="slot">2b</div><div class="slot">2c</div><div class="slot">2d</div>
    <div class="slot">3a</div><div class="slot">3b</div><div class="slot">3c</div><div class="slot">3d</div>
    <div class="slot">4a</div><div class="slot">4b</div><div class="slot">4c</div><div class="slot">4d</div>
    <div class="slot">5a</div><div class="slot">5b</div><div class="slot">5c</div><div class="slot">5d</div>
</div>

<!-- 右側：カメラ → ログ → ボタン2×2 -->
<div id="rightArea">

    <div id="cameraContainer">
        <video id="camera" autoplay playsinline></video>
    </div>

    <div id="log"></div>

    <div id="buttonGrid">
        <button id="modeRead">お題読み取り</button>
        <button id="modeSearch">探索モード</button>
        <button id="photoBtn">撮影(長押し)</button>
        <button id="clearLog">ログ削除</button>
    </div>

</div>

<script>
    const logBox = document.getElementById("log");
    function addLog(msg) {
        logBox.innerHTML += msg + "<br>";
        logBox.scrollTop = logBox.scrollHeight;
    }

    /* カメラ起動 */
    const video = document.getElementById("camera");
    async function startCamera() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({
                video: { facingMode: "environment" },
                audio: false
            });
            video.srcObject = stream;
            addLog("カメラ起動しました");
        } catch (e) {
            addLog("カメラ起動失敗: " + e);
        }
    }
    startCamera();


    /* モード切り替え */
    const modeRead = document.getElementById("modeRead");
    const modeSearch = document.getElementById("modeSearch");

    let currentMode = "read";

    function updateModeButtons() {
        if (currentMode === "read") {
            modeRead.classList.add("active-red");
            modeSearch.classList.remove("active-green");
        } else {
            modeRead.classList.remove("active-red");
            modeSearch.classList.add("active-green");
        }
    }
    updateModeButtons();

    modeRead.onclick = () => {
        currentMode = "read";
        addLog("モード：お題読み取り");
        updateModeButtons();
    };

    modeSearch.onclick = () => {
        currentMode = "search";
        addLog("モード：探索");
        updateModeButtons();
    };

    /* ログ削除 */
    document.getElementById("clearLog").onclick = () => {
        logBox.innerHTML = "";
    };
</script>

</body>
</html>
