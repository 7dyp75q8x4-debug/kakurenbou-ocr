<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>お題＋カメラ＋OCR</title>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
<style>
  body {
    margin: 0;
    background: black;
    color: white;
    font-family: sans-serif;
    overflow: hidden;
  }

  /* 横画面風レイアウト */
  .container {
    display: flex;
    flex-direction: row;
    width: 100vw;
    height: 100vh;
  }

  /* 左: お題リスト */
  .left {
    width: 20%;
    border-right: 2px solid red;
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    padding: 10px;
  }
  .topic {
    border: 2px solid red;
    padding: 20px;
    text-align: center;
    font-size: 2rem;
    cursor: pointer;
  }

  /* 中央：候補top3 */
  .center {
    width: 50%;
    border-right: 2px solid red;
    padding: 10px;
    overflow-y: auto;
  }
  .candidate {
    border: 2px solid red;
    padding: 20px;
    margin-bottom: 20px;
    font-size: 1.4rem;
    min-height: 100px;
  }

  /* 右：カメラ */
  .right {
    width: 30%;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    padding: 10px;
  }

  video {
    width: 100%;
    border: 2px solid red;
    background: #222;
  }

  #captureBtn {
    width: 100%;
    padding: 20px;
    margin-top: 20px;
    font-size: 2rem;
    background: red;
    color: white;
    border: none;
    cursor: pointer;
  }

  #resultBox {
    margin-top: 20px;
    font-size: 1.4rem;
    white-space: pre-wrap;
  }
</style>
</head>
<body>

<div class="container">

  <!-- 左：お題リスト -->
  <div class="left">
    <div class="topic">お題1</div>
    <div class="topic">お題2</div>
    <div class="topic">お題3</div>
    <div class="topic">お題4</div>
    <div class="topic">お題5</div>
  </div>

  <!-- 中央：候補 top3 -->
  <div class="center" id="candidateArea">
    <div class="candidate">お題1候補 top3（写真付き）</div>
    <div class="candidate">お題2候補 top3（写真付き）</div>
    <div class="candidate">お題3候補 top3（写真付き）</div>
    <div class="candidate">お題4候補 top3（写真付き）</div>
    <div class="candidate">お題5候補 top3（写真付き）</div>
  </div>

  <!-- 右：カメラ + 撮影ボタン + OCR結果 -->
  <div class="right">
    <video id="camera" autoplay playsinline></video>
    <button id="captureBtn">カメラ</button>
    <div id="resultBox">OCR結果がここに表示されます</div>
  </div>

</div>

<script>
  const video = document.getElementById("camera");
  const resultBox = document.getElementById("resultBox");

  // カメラ起動
  async function startCamera() {
    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: "environment" }
    });
    video.srcObject = stream;
  }
  startCamera();

  // 撮影してOCR
  document.getElementById("captureBtn").onclick = async () => {
    resultBox.innerText = "解析中...";

    // Canvasに画像を描画
    const canvas = document.createElement("canvas");
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext("2d").drawImage(video, 0, 0);

    // OCR実行
    const { data: { text } } = await Tesseract.recognize(
      canvas,
      "jpn",
      { logger: m => console.log(m) }
    );

    resultBox.innerText = text || "(読み取れませんでした)";
  };
</script>

</body>
</html>
